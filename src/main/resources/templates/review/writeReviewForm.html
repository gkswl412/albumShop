<meta charset="utf-8">
<div id="writeReviewForm" style="background-color:#F8F8F8; width:450px; border:1px solid #cccccc; margin-top:30px">
	앨범 아이디:<input type="text" name="albumId" th:value=${albumId} readonly>
	유저 아이디:<input type="text" name="userId" th:value=${user.id} readonly>
	별점: 
	<select name="rating">
		<option>1</option>
		<option>2</option>
		<option>3</option>
		<option>4</option>
		<option>5</option>
	</select>
	<textarea th:text=${review.content} name="content" style="width:400px; height:500px; border:1px solid #dddddd"></textarea>
	<button id="registerBtn">Register Review</button><button id="cancelBtn" style="float:right">Cancel</button> 
</div>

<script>
	$(function(){
		$("#cancelBtn").on('click',function(){
			$("#btnClickResult").html("");
			$("#addReviewBtn").attr("value","off");
			$("#updateReviewBtn").attr("value","off");
		});
		
		$("#registerBtn").on('click',function(){
			var albumId = [[${albumId}]];
			var userId = "[[${user.id}]]";
			var photo = "[[${user.photo}]]";
			var content = $("textarea[name='content']").val();
			var rating = $("select[name='rating']").val();
			rating = parseInt(rating);
			
			var obj = {
				"multiId":{
					"user":{
						"id":userId,
						"photo":photo
					},
					"album":{
						"id":albumId
					}
				},
				"content":content,
				"rating":rating
			};
			console.log(obj);
			
			if("[[${job}]]"=="create"){
				reviewManager.create(obj, function(list){
					printList(list);
					alert("새로운 리뷰가 추가되었습니다.");
					$("#btnClickResult").html("");
					$("#addReviewBtn").attr("value","off");
				});
			}else{
				reviewManager.create(obj, function(list){
					printList(list);
					alert("리뷰가 수정되었습니다.");
					$("#btnClickResult").html("");
					$("#updateReviewBtn").attr("value","off");
				});
			}
			
			
		});
	});
	
</script>
